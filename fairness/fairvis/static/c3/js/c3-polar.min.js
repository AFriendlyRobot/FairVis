(function(){var n=function(n,t){return function(){return n.apply(t,arguments)}},i={}.hasOwnProperty,t=function(n,t){function u(){this.constructor=n}for(var r in t)i.call(t,r)&&(n[r]=t[r]);return u.prototype=t.prototype,n.prototype=new u,n.__super__=t.prototype,n};c3.Polar=function(i){function r(){return this.toPolar=n(this.toPolar,this),this._style=n(this._style,this),this._draw=n(this._draw,this),this._update=n(this._update,this),this._size=n(this._size,this),this._init=n(this._init,this),r.__super__.constructor.apply(this,arguments)}return t(r,i),r.version=.1,r.prototype.type="polar",r.prototype.layers=[],r.prototype.data=[],r.prototype.r=void 0,r.prototype.t=void 0,r.prototype.angular_range=[0,2*Math.PI],r.prototype.zoomable=!1,r.prototype.zoom_extent=void 0,r.prototype.layer_options=void 0,r.prototype._init=function(){var n,t,r,i;if(this.r==null&&(this.r=d3.scale.linear()),this.t==null&&(this.t=d3.scale.linear()),this.layers_svg=this.content.select("svg.layers",null,!0).singleton(),this.layers_selection=this.layers_svg.select("g.layer").bind(this.layers,function(){return function(n){return n.uid}}(this)).options(this.layer_options,function(n){return n.options}),r=this,this.layers_selection.all.order(),this.layers_selection["new"].each(function(n){return n.trigger("render_start"),n.init(r,d3.select(this)),n.trigger("render")}),this.background=this.content.select("rect.background",":first-child").singleton(),this.zoomable){this.radial_domain=this.r.domain()[1]-this.r.domain()[0];t=1;this.zoomer=d3.behavior.zoom().on("zoom",function(n){return function(){var r,i;return i=n.zoomer.scale(),i!==t&&(n.r.domain([r=n.r.domain()[0],r+n.radial_domain/i]),n._draw("zoom")),t=i}}(this));this.zoom_extent!=null&&this.zoomer.scaleExtent(this.zoom_extent);this.zoomer(this.content.all);this.content.all.on("dblclick.zoom",null);n=void 0;i=function(){return d3.event.timeStamp-(n!=null?n.timeStamp:void 0)<500&&d3.event.touches.length===1&&(d3.event.stopPropagation(),n=void 0),n=d3.event};this.layers_svg.all.on("touchstart.zoom",i);return this.background.all.on("touchstart.zoom",i)}},r.prototype._size=function(){var t,n,r,i;for(this.content.all.attr("transform","translate("+this.width/2+","+this.height/2+")"),this.radius=Math.min(this.width,this.height)/2,this.r.range([0,this.radius-1]),i=this.layers,n=0,r=i.length;n<r;n++)t=i[n],t.size(this.width,this.height),t.t.clamp(!0).range(this.angular_range);return this.background.position({x:-this.width/2,y:-this.height/2,width:this.width,height:this.height})},r.prototype._update=function(n){var r,t,u,i;for(this.layers_selection.update(),i=this.layers,t=0,u=i.length;t<u;t++)r=i[t],r.update(n);return this},r.prototype._draw=function(n){var r,t,u,i;for(i=this.layers,t=0,u=i.length;t<u;t++)r=i[t],r.draw(n);return this},r.prototype._style=function(n){var t,i,u,r;for(this.layers_selection.style(),r=this.layers,i=0,u=r.length;i<u;i++)t=r[i],t.style(n),t.rendered||t.trigger("rendered"),t.rendered=!0;return this},r.toPolar=function(n,t){return[Math.atan(t/n)+(.5+(n<0?1:0))*Math.PI,Math.sqrt(n*n+t*t)]},r.prototype.toPolar=function(n,t){var u,i,r;return r=c3.Polar.toPolar(n,t),i=r[0],u=r[1],i>this.t.range()[1]&&this.t.range()[0]<0&&i>Math.PI&&(i-=2*Math.PI),[this.t.invert(i),this.r.invert(u)]},r}(c3.Chart);c3.Polar.Layer=function(){function t(t){this.toPolar=n(this.toPolar,this);this.redraw=n(this.redraw,this);this.style=n(this.style,this);this.draw=n(this.draw,this);this.update=n(this.update,this);this.size=n(this.size,this);this.init=n(this.init,this);c3.util.extend(this,new c3.Dispatch);c3.util.extend(this,t);this.uid=c3.Polar.Layer._next_uid++}return t.version=.1,t.prototype.type="layer",t._next_uid=0,t.prototype.data=void 0,t.prototype.name=void 0,t.prototype["class"]=void 0,t.prototype.r=void 0,t.prototype.t=void 0,t.prototype.options=void 0,t.prototype.handlers=void 0,t.prototype.init=function(n,t){var r,f,i,u;if(this.chart=n,this.g=t,this.r==null&&(this.r=this.chart.r),this.t==null&&(this.t=this.chart.t),this.data==null&&(this.data=this.chart.data),this["class"]!=null&&this.g.classed(this["class"],!0),this.handlers!=null){u=this.handlers;for(r in u){f=u[r];this.on(r,f)}}for(this.content=c3.select(this.g),i=Object.getPrototypeOf(this);i;)i.type!=null&&this.g.classed(i.type,!0),i=Object.getPrototypeOf(i);return this._init()},t.prototype._init=function(){},t.prototype.size=function(n,t){return this.width=n,this.height=t,this.trigger("resize_start"),this.radius=this.chart.radius,this.r!==this.chart.r&&this.r.range([0,this.chart.radius-1]),this._size(),this.trigger("resize")},t.prototype._size=function(){},t.prototype.update=function(n){if(this.chart==null)throw Error("Attempt to redraw uninitialized polar layer, please use render() when adding new layers");return this._update(n)},t.prototype._update=function(){},t.prototype.draw=function(n){return this.trigger("redraw_start",n),this._draw(n),this.trigger("redraw",n)},t.prototype._draw=function(){},t.prototype.style=function(n){return this.trigger("restyle",n),this._style(n),this.trigger("restyle",n),this},t.prototype._style=function(){},t.prototype.redraw=function(n){return n==null&&(n="redraw"),this.update(n),this.draw(n),this.style(!0),this},t.prototype.restyle=t.prototype.style,t.prototype.toPolar=function(n,t){var u,i,r;return r=c3.Polar.toPolar(n,t),i=r[0],u=r[1],i>this.t.range()[1]&&this.t.range()[0]<0&&i>Math.PI&&(i-=2*Math.PI),[this.t.invert(i),this.r.invert(u)]},t}();c3.Polar.Layer.Radial=function(i){function r(){return this._draw=n(this._draw,this),r.__super__.constructor.apply(this,arguments)}return t(r,i),r.version=.1,r.prototype.type="radial",r.prototype.key=void 0,r.prototype.value=void 0,r.prototype.filter=void 0,r.prototype.inner_radius=0,r.prototype.outer_radius=Infinity,r.prototype.vector_options=void 0,r.prototype.line_options=void 0,r.prototype._init=function(){var n,t;if(this.value==null&&(this.value=function(n){return n}),this.draggable){t=this;n=void 0;this.dragger=d3.behavior.drag();this.dragger.on("dragstart",function(n){return function(t,i){return d3.event.sourceEvent.stopPropagation(),n.trigger("dragstart",t,i)}}(this));this.dragger.on("drag",function(i,r){var f,u;return u=t.toPolar(d3.event.x,d3.event.y),n=u[0],f=u[1],d3.select(this).attr("transform","rotate("+(t.t(n)*180/Math.PI-180)+")"),t.trigger("drag",n,i,r)});return this.dragger.on("dragend",function(t){return function(i,r){return t.trigger("dragend",n,i,r)}}(this))}},r.prototype._update=function(n){var i,t;return this.current_data=this.filter!=null?function(){var n,f,r,u;for(r=this.data,u=[],t=n=0,f=r.length;n<f;t=++n)i=r[t],this.filter(i,t)&&u.push(i);return u}.call(this):this.data,this.vectors=this.content.select("g.vector").options(this.vector_options).animate(n==="redraw").bind(this.current_data,this.key).update(),this.lines=this.vectors.inherit("line").options(this.line_options).update()},r.prototype._draw=function(n){var t,i,r;return t=c3.functor(this.inner_radius),r=c3.functor(this.outer_radius),n!=="rebase"?this.vectors.animate(n==="redraw"||n==="revalue").position({transform:function(n){return function(t,i){return"rotate("+(n.t(n.value(t,i))*180/Math.PI-180)+")"}}(this)}):this.vectors.animate(!0).position_tweens({transform:function(n){return function(t,i){return function(){return"rotate("+(n.t(n.value(t,i))*180/Math.PI-180)+")"}}}(this)}),this.lines.animate(n==="redraw"||n==="rebase").position(i={y1:function(n){return function(i,r){return n.r(t(i,r))}}(this),y2:function(n){return function(t,i){var u;return n.r((u=r(t,i))!==Infinity?u:window.innerHeight+window.innerWidth)}}(this)}),this.draggable?(this.vectors["new"].call(this.dragger),this.grab_lines=this.vectors.inherit("line.grab").animate(n==="redraw"||n==="rebase").position(i)):void 0},r.prototype._style=function(n){return this.g.classed("draggable",this.draggable),this.vectors.style(n),this.lines.style(n)},r}(c3.Polar.Layer);c3.Polar.Layer.Segment=function(i){function r(){return this.get_position_from_key=n(this.get_position_from_key,this),this._style=n(this._style,this),this._draw=n(this._draw,this),this._update=n(this._update,this),this._init=n(this._init,this),r.__super__.constructor.apply(this,arguments)}return t(r,i),r.version=.1,r.prototype.type="segment",r.prototype.key=void 0,r.prototype.value=void 0,r.prototype.limit_elements=void 0,r.prototype.pad=void 0,r.prototype.arc_options=void 0,r.prototype._init=function(){var n;return this.arc_options.animate&&(n=this.arc_options).animate_old==null&&(n.animate_old=!0),this.arc=d3.svg.arc().innerRadius(function(n){return function(t){return Math.max(0,n.r(t.y1))}}(this)).outerRadius(function(n){return function(t){return Math.max(0,n.r(t.y2))}}(this)).startAngle(function(n){return function(t){return n.t(t.x1)}}(this)).endAngle(function(n){return function(t){return n.t(t.x2)}}(this)).padAngle(this.pad),this.segments=this.content.select("g.segments").singleton(),this.nodes=[]},r.prototype._update=function(n){return this.current_data=this._layout(this.data,n),this.current_data.length>this.limit_elements&&(this.current_data===this.data&&(this.current_data=this.data.slice(0)),c3.array.sort_up(this.current_data,this.value),this.current_data=this.current_data.slice(-this.limit_elements)),this.arcs=this.segments.select("path").options(this.arc_options).animate(n==="redraw"||n==="revalue"||n==="rebase").bind(this.current_data,this.key).update()},r.prototype._draw=function(n){var i,r,u,f,t,e,o,s;return this.root_nodes!=null&&(t=(o=this.root_node)!=null?o:{x1:0,x2:1,y1:0},u=(s=n!=="rebase"?this.prev_t_domain:void 0)!=null?s:this.t.domain(),this.prev_t_domain=[t.x1,t.x2],r=[t.x1,t.x2],i=[t.y1-1,t.y1-1+this.r.domain()[1]-this.r.domain()[0]],e=d3.interpolate(u,r),f=d3.interpolate(this.r.domain(),i),this.r.domain(i),this.t.domain(r)),this.arcs.animate(n==="redraw"||n==="revalue"||n==="rebase").position_tweens({d:function(n){return function(t){var r,i,u,o,s,h;return i=n.nodes[n.key(t)],r=d3.interpolateObject({x1:(u=i.px1)!=null?u:i.x1,x2:(o=i.px2)!=null?o:i.x2,y1:(s=i.py1)!=null?s:i.y1,y2:(h=i.py2)!=null?h:i.y2},i),function(t){return n.root_nodes!=null&&(n.t.domain(e(t)),n.r.domain(f(t))),n.arc(r(t))}}}(this)}),n==="zoom"?this.arcs.old.remove():void 0},r.prototype._style=function(n){return this.arcs.style(n)},r.prototype.get_position_from_key=function(n){var t;if((t=this.nodes)!=null)return t[n]},r}(c3.Polar.Layer);c3.Polar.Layer.Arc=function(i){function r(){return this._layout=n(this._layout,this),r.__super__.constructor.apply(this,arguments)}return t(r,i),r.version=.1,r.prototype.type="arc",r.prototype.inner_radius=0,r.prototype.outer_radius=1,r.prototype.start_angle=0,r.prototype.end_angle=2*Math.PI,r.prototype._layout=function(n){var r,e,i,o,u,t,s,h,f,c;for(h=c3.functor(this.start_angle),e=c3.functor(this.end_angle),o=c3.functor(this.inner_radius),s=c3.functor(this.outer_radius),i=f=0,c=n.length;f<c;i=++f)r=n[i],u=this.key(r,i),t=this.nodes[u],this.nodes[u]={px1:t!=null?t.x1:void 0,px2:t!=null?t.x2:void 0,py1:t!=null?t.y1:void 0,py2:t!=null?t.y2:void 0,x1:h(r,i),x2:e(r,i),y1:o(r,i),y2:s(r,i)};return n},r}(c3.Polar.Layer.Segment);c3.Polar.Layer.Pie=function(i){function r(){return this._style=n(this._style,this),this._draw=n(this._draw,this),this._layout=n(this._layout,this),this._init=n(this._init,this),r.__super__.constructor.apply(this,arguments)}return t(r,i),r.version=.1,r.prototype.type="pie",r.prototype.sort=!1,r.prototype.inner_radius=0,r.prototype.outer_radius=1,r.prototype.other_options=void 0,r.prototype._init=function(){if(r.__super__._init.apply(this,arguments),this.key==null)throw Error("key() accessor required for Pie charts");},r.prototype._layout=function(n){var f,i,s,h,e,t,c,o,r,u,l,a;for(h=c3.functor(this.inner_radius),c=c3.functor(this.outer_radius),o=0,r=0,l=n.length;r<l;r++)i=n[r],o+=this.value(i);for(f=0,s=1/(o||1),this.sort&&(n=n.slice(0),c3.array.sort_down(n,this.value)),u=0,a=n.length;u<a;u++)i=n[u],e=this.key(i),t=this.nodes[e],this.nodes[e]={px1:t!=null?t.x1:void 0,px2:t!=null?t.x2:void 0,py1:t!=null?t.y1:void 0,py2:t!=null?t.y2:void 0,x1:f,x2:f+=this.value(i)*s,y1:h(i),y2:c(i)};return n},r.prototype._draw=function(n){return r.__super__._draw.apply(this,arguments),this.other_options?(this.other_arc=this.content.select("path.other").options(this.other_options).animate(n==="redraw"),this.data.length>this.limit_elements&&this.sort===!0?this.other_arc.singleton().update().position_tweens({d:function(n){return function(){var i,t,r;return t={x1:n.nodes[n.key(n.current_data[0])].x2,x2:1,y1:c3.functor(n.inner_radius)(),y2:c3.functor(n.outer_radius)()},i=d3.interpolateObject((r=n.prev_other_node)!=null?r:t,t),n.prev_other_node=t,function(t){return n.arc(i(t))}}}(this)}):this.other_arc.bind([])):void 0},r.prototype._style=function(n){var t;return r.__super__._style.apply(this,arguments),(t=this.other_arc)!=null?t.style(n):void 0},r}(c3.Polar.Layer.Segment);c3.Polar.Layer.Sunburst=function(i){function r(){return this.get_leaf=n(this.get_leaf,this),this._style=n(this._style,this),this._draw=n(this._draw,this),this._update=n(this._update,this),this.rebase_key=n(this.rebase_key,this),this.rebase=n(this.rebase,this),this._layout=n(this._layout,this),this._init=n(this._init,this),r.__super__.constructor.apply(this,arguments)}return t(r,i),r.version=.1,r.prototype.type="sunburst",r.prototype.self_value=void 0,r.prototype.sort=!1,r.prototype.parent_key=void 0,r.prototype.children=void 0,r.prototype.limit_angle_percentage=.001,r.prototype._init=function(){var n,t,i,u,f;if(r.__super__._init.apply(this,arguments),this.key==null)throw Error("key() accessor required for Sunburst layers");return this.arc_options==null&&(this.arc_options={}),(n=this.arc_options).events==null&&(n.events={}),(t=this.arc_options.events).click==null&&(t.click=function(n){return function(t){return n.rebase(t)}}(this)),this.bullseye=this.content.select("circle.bullseye"),this.bullseye_options==null&&(this.bullseye_options={}),(i=this.bullseye_options).events==null&&(i.events={}),(u=this.bullseye_options.events).click==null&&(u.click=function(n){return function(){return n.rebase(null)}}(this)),(f=this.bullseye_options).title==null&&(f.title="Navigate to root of tree"),this.center=this.content.select("circle.center").singleton()},r.prototype._layout=function(n,t){var y,p,w,b,u,f,o,i,r,e,et,s,k,h,d,g,nt,c,l,a,tt,v,ot,st,ht,ct,it,rt,ut,ft,lt,at,vt,yt;if(t!=="revalue"&&t!=="rebase"){if(et=this.nodes,r=[],this.parent_key!=null){for(this.root_nodes=[],l=0,ot=n.length;l<ot;l++)u=n[l],i=r[it=this.key(u)]!=null?r[it]:r[it]={children:[]},i.datum=u,s=this.parent_key(u),s!=null?(k=r[s],k?k.children.push(i):r[s]={children:[i]}):this.root_nodes.push(i);for(g=function(){return function(n,t){var f,i,e,r,u;for(n.y1=t,n.y2=t+1,r=n.children,u=[],i=0,e=r.length;i<e;i++)f=r[i],u.push(g(f,t+1));return u}}(this),rt=this.root_nodes,a=0,st=rt.length;a<st;a++)i=rt[a],g(i,0)}else y=function(n){return function(t,u){var f;return i=r[n.key(t)]={datum:t,y1:u,y2:u+1,children:n.children!=null?function(){var n,e,o,i,r;for(i=(o=this.children(t))!=null?o:[],r=[],n=0,e=i.length;n<e;n++)f=i[n],r.push(y(f,u+1));return r}.call(n):[]}}}(this),this.root_nodes=function(){var t,r,i;for(i=[],t=0,r=n.length;t<r;t++)u=n[t],i.push(y(u,0));return i}();if(this.arc_options.animate)for(f=tt=0,ht=r.length;tt<ht;f=++tt)i=r[f],e=et[f],e!=null&&(i.x1=e.x1,i.x2=e.x2,i.py1=e.y1,i.py2=e.y2);this.nodes=r}if(t!=="rebase")if(this.self_value!=null)for(c=this.self_value,this.value=function(n){return function(t){return n.nodes[n.key(t)].value}}(this),w=function(n){var r,t,u,i;for(n.value=c(n.datum),i=n.children,t=0,u=i.length;t<u;t++)r=i[t],n.value+=w(r);return n.value},ut=this.root_nodes,v=0,ct=ut.length;v<ct;v++)i=ut[v],w(i,0);else{c=this.value;ft=this.nodes;for(f in ft)i=ft[f],i.value=c(i.datum)}return this.sort&&t!=="revalue"&&t!=="rebase"&&(nt=this.sort===!0?function(n){return-n.value}:function(n){return function(t){return-n.sort(t.datum)}}(this)),o=this.limit_angle_percentage,this.root_node!=null&&(o*=this.root_node.x2-this.root_node.x1),h=function(){return function(n,t,r){var u,s,c,l,a,v,f,e;if(s=t[1]-t[0],u=t[0],!r||s<o){for(f=0,a=n.length;f<a;f++)(i=n[f],i.px1!==u||i.px2!==u||i.x1!==u||i.x2!==u)&&(i.px1=i.x1,i.px2=i.x2,i.x1=u,i.x2=u,i.children.length&&h(i.children,t,0));return!1}for(nt&&c3.array.sort_up(n,nt),c=s/r,e=0,v=n.length;e<v;e++)i=n[e],i.px1=i.x1,i.px2=i.x2,i.x1=l=u,i.x2=u+=c*i.value,i.children.length&&h(i.children,[l,u],i.value);return!0}}(this),h(this.root_nodes,[0,1],d3.sum(this.root_nodes,function(n){return n.value}),0),b=[],d=[(lt=(at=this.root_node)!=null?at.x1:void 0)!=null?lt:0,(vt=(yt=this.root_node)!=null?yt.x2:void 0)!=null?vt:1],p=function(n){var u,r,t;for(t=[],r=0,u=n.length;r<u;r++)i=n[r],i.x2-i.x1>o&&i.x2>d[0]&&i.x1<d[1]?(b.push(i.datum),i.children.length?t.push(p(i.children)):t.push(void 0)):t.push(void 0);return t},p(this.root_nodes),b},r.prototype.rebase=function(n){return n?this.rebase_key(this.key(n)):this.rebase_key(null)},r.prototype.rebase_key=function(n){var t,i;return this.root_node=n!=null?this.nodes[n]:null,this.trigger("rebase_start",(t=this.root_node)!=null?t.datum:void 0),this.chart.redraw("rebase"),this.trigger("rebase",(i=this.root_node)!=null?i.datum:void 0)},r.prototype._update=function(n){return r.__super__._update.apply(this,arguments),this.center.options(this.center_options).update(),this.bullseye.options(this.bullseye_options).animate(n==="redraw"||n==="rebase").bind(this.root_node!=null?[this.root_node.datum]:[]).update()},r.prototype._draw=function(n){var t,i;return r.__super__._draw.apply(this,arguments),this.bullseye.animate(n==="redraw").position({r:Math.max(0,this.r(this.r.domain()[0]+.5))}),n!=="rebase"?this.center.animate(n==="redraw").position({r:Math.max(0,this.r((t=(i=this.root_node)!=null?i.y1:void 0)!=null?t:0))}):void 0},r.prototype._style=function(n){return r.__super__._style.apply(this,arguments),this.center.style(n),this.bullseye.style(n)},r.prototype.get_leaf=function(n){var t;if(this.root_nodes!=null)return t=function(i,r){for(var u,f=0,e=i.length;f<e;f++)if(u=i[f],u.x1<=n&&n<=u.x2)return u.children.length?t(u.children,u):u.datum;return r.datum},t(this.root_nodes)},r}(c3.Polar.Layer.Segment)}).call(this);
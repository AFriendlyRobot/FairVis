(function(){var n=function(n,t){return function(){return n.apply(t,arguments)}},i={}.hasOwnProperty,r=function(n,t){function u(){this.constructor=n}for(var r in t)i.call(t,r)&&(n[r]=t[r]);return u.prototype=t.prototype,n.prototype=new u,n.__super__=t.prototype,n},u=[].slice,t=[].indexOf||function(n){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===n)return t;return-1};c3.Table=function(i){function f(){this.select=n(this.select,this);this.highlight=n(this.highlight,this);this.sort=n(this.sort,this);this._style=n(this._style,this);this._update=n(this._update,this);this._update_headers=n(this._update_headers,this);this._init=n(this._init,this);f.__super__.constructor.apply(this,arguments);this.selections=[]}return r(f,i),f.version=.1,f.prototype.type="table",f.prototype.data=[],f.prototype.key=void 0,f.prototype.filter=void 0,f.prototype.columns=[],f.prototype.selectable=!1,f.prototype.sortable=!1,f.prototype.sort_column=void 0,f.prototype.limit_rows=void 0,f.prototype.pagination=!1,f.prototype.max_pages_in_paginator=9,f.prototype.searchable=!1,f.prototype.searchable_if_not_paginated=!0,f.prototype.table_options=void 0,f.prototype.table_header_options=void 0,f.prototype.header_options=void 0,f.prototype.footer_options=void 0,f.prototype.table_body_options=void 0,f.prototype.row_options=void 0,f.prototype.cell_options=void 0,f.prototype.vis_options=void 0,f.prototype._init=function(){var n,r,u,f,e,t,o,i;for(this.table=c3.select(d3.select(this.anchor),"table").singleton(),this.table_options==null&&(this.table_options={}),(r=this.table_options).styles==null&&(r.styles={}),(u=this.table_options.styles).width==null&&(u.width="100%"),this.table.options(this.table_options).update(),this.header=this.table.inherit("thead").inherit("tr"),this.header.options(this.table_header_options).update(),this.body=this.table.inherit("tbody"),this.body.options(this.table_body_options).update(),this.next_column_key==null&&(this.next_column_key=0),i=this.columns,t=0,o=i.length;t<o;t++){if(n=i[t],n.key==null&&(n.key=this.next_column_key++),n.header==null&&(n.header={}),(f=n.header).text==null&&(f.text=""),n.cells==null&&(n.cells={}),(e=n.cells).text==null&&(e.text=""),n.sortable==null&&(n.sortable=n.sort!=null),n.value==null&&(n.value=n.sort),n.sort==null&&(n.sort=n.value),n.sortable&&n.sort==null)throw"column.sort() or column.value() not defined for a sortable column";if(n.vis&&n.value==null)throw"column.value() not defined for a column with a column.vis visualization";}return this._update_headers()},f.prototype._update_headers=function(){var n;n=this;this.headers=this.header.select("th").bind(this.columns,function(n){return n.key}).options(this.header_options,function(n){return n.header}).update();this.headers["new"].on("click.sort",function(n){return function(t){if(n.sortable&&t.sortable)return n.sort(t)}}(this));if(this.sortable)return this.headers.all.each(function(t){var i;if(t===n.sort_column)return i=d3.select(this),i.html(i.html()+("<span class='arrow' style='float:right'>"+(t.sort_ascending?"▲":"▼")+"<\/span>"))})},f.prototype._update=function(n){var b,t,f,e,ot,st,i,h,k,a,d,c,g,r,l,o,nt,v,s,y,tt,it,p,w,ht,ct,rt,lt,at,ut,ft,et;for(it=this,rt=this.columns,p=0,ht=rt.length;p<ht;p++)if((t=rt[p],t.vis)&&(t.value_total=(lt=(at=typeof t.total_value=="function"?t.total_value():void 0)!=null?at:t.total_value)!=null?lt:void 0,t.value_total==null))for(t.value_total=0,ut=this.data,w=0,ct=ut.length;w<ct;w++)st=ut[w],t.value_total+=t.value(st);if(this.current_data=this.filter!=null?function(){var n,u,t,r;for(t=this.data,r=[],i=n=0,u=t.length;n<u;i=++n)e=t[i],this.filter(e,i)&&r.push(e);return r}.call(this):this.data,this.sort_column!=null&&(this.filter==null&&(this.current_data=this.current_data.slice(0)),c3.array.sort_up(this.current_data,this.sort_column.sort),this.sort_column.sort_ascending||this.current_data.reverse()),ot=function(){if(this.limit_rows){if(this.limit_rows=Math.floor(this.limit_rows),isNaN(this.limit_rows))throw Error("limit_rows set to non-numeric value: "+this.limit_rows);return f=isNaN(this.pagination)?1:this.pagination,f=Math.max(1,Math.min(Math.ceil(this.current_data.length/this.limit_rows),f)),this.pagination&&(this.pagination=f),this.current_data.slice(this.limit_rows*(f-1),+(this.limit_rows*f-1)+1||9e9)}return this.current_data}.call(this),this.rows=this.body.select("tr").bind(ot,this.key),this.rows.options(this.row_options).update(),this.key!=null&&this.rows.all.order(),this.cells=this.rows.select("td").bind(function(n){return function(i){var r,e,u,f;for(u=n.columns,f=[],r=0,e=u.length;r<e;r++)t=u[r],f.push(i);return f}}(this),function(n){return function(t,i){return n.columns[i].key}}(this)),this.columns.some(function(n){return n.vis!=null})?(this.vis=this.cells.inherit("div.vis"),this.vis.options(this.vis_options,function(n){return function(t,i){return n.columns[i].vis_options}}(this)).update(),b=this.vis.inherit("span"),this.vis.all.each(function(n,i){t=it.columns[i%it.columns.length];switch(t.vis){case"bar":return d3.select(this).classed("bar",!0).style("width",t.value(n)/t.value_total*100+"%")}})):b=this.cells,b.options(this.cell_options,function(n){return function(t,i){return n.columns[i].cells}}(this)).update(),this.cells.options(this.cell_options,function(n){return function(t,i){return n.columns[i].cells}}(this)),this.selectable){(n==="render"?this.rows.all:this.rows["new"]).on("click.select",function(n){return function(t){return n.select(c3.Table.set_select(n.selections,t,n.selectable==="multi"||n.selectable===!0&&d3.event.ctrlKey))}}(this));this.highlight()}else if(n==="render")this.rows.all.on("click.select",null);if(this.footer=this.table.select("caption"),l=!!this.limit_rows&&this.pagination&&this.current_data.length>this.limit_rows,tt=this.searchable&&(this.searchable_if_not_paginated||l),tt||l){if(this.footer.singleton().options(this.footer_options).update(),o=this.footer.select("span.pagination",":first-child"),l){o.singleton();c=Math.ceil(this.current_data.length/this.limit_rows);this.max_pages_in_paginator=Math.floor(Math.max(this.max_pages_in_paginator,3));a=Math.ceil((this.max_pages_in_paginator-3)/2);v=Math.floor((this.max_pages_in_paginator-3)/2);nt=o.select("span.prev.button").singleton();nt["new"].text("◀").on("click",function(n){return function(){return n.pagination--,n.redraw()}}(this));nt.all.classed("disabled",f<=1);r=[1].concat(u.call(c>2?function(){et=[];for(var n=ft=Math.max(2,Math.min(this.pagination-a,c-1-a-v)),t=Math.min(c-1,Math.max(f+v,2+a+v));ft<=t?n<=t:n>=t;ft<=t?n++:n--)et.push(n);return et}.apply(this):[]),[c]);r[1]-r[0]>1&&r.splice(1,0,"…");r[r.length-1]-r[r.length-2]>1&&r.splice(r.length-1,0,"…");g=o.select("ul").singleton().select("li").bind(r);g["new"].on("click",function(n){return function(t){return n.pagination=t,n.redraw()}}(this));g.all.classed("active",function(){return function(n){return n===f}}(this)).classed("disabled",function(){return function(n){return n==="…"}}(this)).text(function(n){return n});d=o.select("span.next.button").singleton();d["new"].text("▶").on("click",function(n){return function(){return n.pagination++,n.redraw()}}(this));d.all.classed("disabled",f>=this.current_data.length/this.limit_rows)}else o.remove();if(s=this.footer.select("span.search"),!tt||!l&&this.current_data.length>this.limit_rows)return s.remove();k="";h=-1;s.singleton();s.inherit("span.button")["new"].text("🔎").on("click",function(n){return function(){var u,s,c,r,f,l,o;if(y.node().classList.remove("notfound"),r=y.node().value,r){for(c=RegExp(r,"i"),r!==k&&(h=-1,k=r),s=n.searchable===!0?(u=function(){var n,u,i,f,e,o,r;for(i=this.columns,r=[],n=0,u=i.length;n<u;n++)t=i[n],r.push(c3.functor((f=(e=(o=t.cells.html)!=null?o:t.cells.text)!=null?e:this.cell_options.html)!=null?f:this.cell_options.text));return r}.call(n),function(n,t){var r,i;return function(){var f,o,e;for(e=[],i=f=0,o=u.length;f<o;i=++f)r=u[i],e.push(r(n,t,i));return e}().join(" ")}):n.searchable,o=n.current_data,i=f=0,l=o.length;f<l;i=++f)if(e=o[i],i>h&&c.test(s(e,i))){h=i;n.pagination=Math.ceil((i+1)/n.limit_rows);n.redraw();n.trigger("match",r,e,i);return}return h=-1,y.node().classList.add("notfound"),n.trigger("match",r,null,null)}}}(this));return y=s.inherit("input")["new"].attr("type","text").on("keydown",function(){return this.classList.remove("notfound"),this.value&&d3.event.keyCode===13?s.select(".button").node().click():void 0})}return this.footer.remove()},f.prototype._style=function(n){var r,o,u,t,f,i,e;if(o=this,this.table.style().all.classed({c3:!0,table:!0,sortable:this.sortable,selectable:this.selectable,single_select:this.selectable==="single",multi_select:this.selectable==="multi",paginated:this.pagination&&this.limit_rows&&this.current_data.length>this.limit_rows,searchable:!!this.searchable}),this["class"]!=null)for(i=this["class"].split(" "),t=0,f=i.length;t<f;t++)r=i[t],this.table.all.classed(r,!0);return this.header.style(),this.headers.style(n).all.classed({sortable:this.sortable?function(n){return n.sort!=null}:!1,sorted:function(n){return function(t){return t===n.sort_column}}(this)}),this.body.style(),this.rows.style(n),u=this.columns.indexOf(this.sort_column),this.cells.style(n&&this.key!=null).all.classed({sorted:function(n,t){return t===u}}),(e=this.vis)!=null?e.style(n&&this.key!=null):void 0},f.prototype.sort=function(n,t){if(n.sort)return t!=null?n.sort_ascending=t:this.sort_column===n&&(n.sort_ascending=!n.sort_ascending),this.sort_column=n,this._update_headers(),this.redraw("sort")},f.prototype.highlight=function(n){return this.selections=n!=null?n:this.selections,this.rows.all.classed("selected",this.selections.length?function(n){return function(i){return t.call(n.selections,i)>=0}}(this):!1),this.rows.all.classed("deselected",this.selections.length?function(n){return function(i){return!(t.call(n.selections,i)>=0)}}(this):!1)},f.prototype.select=function(n){return this.selections=n!=null?n:this.selections,this.highlight(),this.trigger("select",this.selections)},f.set_select=function(n,i,r){if(n==null)return[i];if(r)t.call(n,i)>=0?c3.array.remove_item(n,i):n.push(i);else switch(n.length){case 0:n.push(i);break;case 1:t.call(n,i)>=0?n.length=0:(n.length=0,n.push(i));break;default:n.length=0;n.push(i)}return n},f}(c3.Base)}).call(this);